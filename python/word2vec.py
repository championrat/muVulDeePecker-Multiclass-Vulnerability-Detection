from gensim.models.word2vec import *
from python.getToken import *
import gc

class wordVector():
    def __init__(self, sentences):
        self.sentences = sentences

    def __iter__(self):
        for line in self.sentences.splitlines():
            print(line)
            yield toTokens(line)
            gc.collect()

def generateWord2Vec(sentences):
    '''
    Parameters
    ----------
    sentences: Nhận đầu vào là một gadget
    '''
    model = Word2Vec(
        sentences=wordVector(sentences),
        vector_size=50,
        window=50,
        sg=1, 
        min_count=1
    )   
    model.save("w2c.model")

def evaluate_w2vModel(w2vModelPath):
    '''
    Parameters
    ----------
    w2vModelPath: Đường dẫn tới file model đã train
    '''
    model = Word2Vec.load(w2vModelPath)
    for sign in ['(', '+', '-', '*']:
        print(sign, ":")
        print(model.wv.most_similar_cosmul(positive=[sign], topn=10))